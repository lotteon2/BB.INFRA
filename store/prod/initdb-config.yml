apiVersion: v1
kind: ConfigMap
metadata:
  name: store-initdb-config
  namespace: prod
data:
  initdb.sql: |
    CREATE TABLE `sido` (
      `code` varchar(255) NOT NULL,
      `name` varchar(255) DEFAULT NULL,
      PRIMARY KEY (`code`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

    CREATE TABLE `gugun` (
      `code` varchar(255) NOT NULL,
      `name` varchar(255) DEFAULT NULL,   
      `sido_code` varchar(255) NOT NULL,
      PRIMARY KEY (`code`),
      KEY `FKmo0wy3m4s7r0a010530y001ig` (`sido_code`),
      CONSTRAINT `FKmo0wy3m4s7r0a010530y001ig` FOREIGN KEY (`sido_code`) REFERENCES `sido` (`code`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


    CREATE TABLE `store` (
      `id` bigint NOT NULL AUTO_INCREMENT,
      `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `is_deleted` bit(1) DEFAULT false NULL,
      `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `account_number` varchar(255) NOT NULL,
      `average_rating` float NOT NULL DEFAULT '0',
      `bank` varchar(255) NOT NULL,
      `detail_info` varchar(255) NOT NULL,
      `phone_number` varchar(255) NOT NULL,
      `store_code` varchar(255) NOT NULL,
      `store_manager_id` bigint NOT NULL,
      `store_name` varchar(255) NOT NULL,
      `store_thumbnail_image` varchar(255) NOT NULL,
      PRIMARY KEY (`id`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

    CREATE TABLE `delivery_policy` (
      `id` bigint NOT NULL AUTO_INCREMENT,
      `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `is_deleted` bit(1) DEFAULT false NULL,
      `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `delivery_price` bigint NOT NULL,
      `free_delivery_min_price` bigint NOT NULL,
      `store_id` bigint DEFAULT NULL,
      PRIMARY KEY (`id`),
      KEY `FKh4826a7siy7t3fcifku371j16` (`store_id`),
      CONSTRAINT `FKh4826a7siy7t3fcifku371j16` FOREIGN KEY (`store_id`) REFERENCES `store` (`id`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

    CREATE TABLE `store_address` (
      `id` bigint NOT NULL AUTO_INCREMENT,
      `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `is_deleted` bit(1) DEFAULT false NULL,
      `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `address` varchar(255) NOT NULL,
      `detail_address` varchar(255) NOT NULL,
      `lat` double NOT NULL,
      `lon` double NOT NULL,
      `zip_code` varchar(255) NOT NULL,
      `gugun_code` varchar(255) DEFAULT NULL,
      `sido_code` varchar(255) DEFAULT NULL,
      `store_id` bigint DEFAULT NULL,
      PRIMARY KEY (`id`),
      KEY `FKtf1wxbnimrsetxx9ehd2ee2tn` (`gugun_code`),
      KEY `FKk1bni038rsjegrmewrxw84bvi` (`sido_code`),
      KEY `FK2nf8ejue99xx11ikh2m8adkae` (`store_id`),
      CONSTRAINT `FK2nf8ejue99xx11ikh2m8adkae` FOREIGN KEY (`store_id`) REFERENCES `store` (`id`),
      CONSTRAINT `FKk1bni038rsjegrmewrxw84bvi` FOREIGN KEY (`sido_code`) REFERENCES `sido` (`code`),
      CONSTRAINT `FKtf1wxbnimrsetxx9ehd2ee2tn` FOREIGN KEY (`gugun_code`) REFERENCES `gugun` (`code`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

    CREATE TABLE `flower_cargo` (
      `flower_id` bigint NOT NULL,
      `store_id` bigint NOT NULL,
      `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `is_deleted` bit(1) DEFAULT false NULL,
      `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `flower_name` varchar(255) DEFAULT NULL,
      `stock` bigint NOT NULL DEFAULT '0',
      PRIMARY KEY (`flower_id`,`store_id`),
      KEY `FKq0mwssjfc2s2r2rerofo79an1` (`store_id`),
      CONSTRAINT `FKq0mwssjfc2s2r2rerofo79an1` FOREIGN KEY (`store_id`) REFERENCES `store` (`id`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

    CREATE TABLE `question` (
      `id` bigint NOT NULL AUTO_INCREMENT,
      `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `is_deleted` bit(1) DEFAULT false NULL,
      `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `content` varchar(255) NOT NULL,
      `is_read` tinyint(1) NOT NULL DEFAULT '0',
      `is_secret` tinyint(1) NOT NULL DEFAULT '0',
      `nickname` varchar(255) NOT NULL,
      `product_id` varchar(255) NOT NULL,
      `product_name` varchar(255) NOT NULL,
      `title` varchar(255) NOT NULL,
      `user_id` bigint NOT NULL,
      `store_id` bigint DEFAULT NULL,
      PRIMARY KEY (`id`),
      KEY `FKh76hunyr9grd50gpy0l128dyd` (`store_id`),
      CONSTRAINT `FKh76hunyr9grd50gpy0l128dyd` FOREIGN KEY (`store_id`) REFERENCES `store` (`id`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

    CREATE TABLE `answer` (
      `id` bigint NOT NULL,
      `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `is_deleted` bit(1) DEFAULT false NULL,
      `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `content` varchar(255) NOT NULL,
      PRIMARY KEY (`id`),
      CONSTRAINT `FKrbm8pweys4s5fd0k18950p7y0` FOREIGN KEY (`id`) REFERENCES `question` (`id`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;

    CREATE TABLE `coupon` (
      `id` bigint NOT NULL AUTO_INCREMENT,
      `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `is_deleted` bit(1) DEFAULT false NULL,
      `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `coupon_code` varchar(255) NOT NULL,
      `coupon_name` varchar(255) NOT NULL,
      `discount_price` bigint NOT NULL,
      `end_date` date NOT NULL,
      `limit_count` int NOT NULL,
      `min_price` bigint NOT NULL,
      `start_date` date NOT NULL,
      `store_id` bigint DEFAULT NULL,
      PRIMARY KEY (`id`),
      KEY `FKs7yl3mm1m0o7fmn6et7guwo89` (`store_id`),
      CONSTRAINT `FKs7yl3mm1m0o7fmn6et7guwo89` FOREIGN KEY (`store_id`) REFERENCES `store` (`id`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;


    CREATE TABLE `issued_coupon` (
      `coupon_id` bigint NOT NULL,
      `user_id` bigint NOT NULL,
      `created_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `is_deleted` bit(1) DEFAULT false NULL,
      `updated_at` DATETIME DEFAULT CURRENT_TIMESTAMP NULL,
      `is_used` tinyint(1) NOT NULL DEFAULT '0',
      PRIMARY KEY (`coupon_id`,`user_id`),
      CONSTRAINT `FK6tlq06yimib5ocxhp6qw0iemg` FOREIGN KEY (`coupon_id`) REFERENCES `coupon` (`id`)
    ) ENGINE=InnoDB DEFAULT CHARSET=utf8mb4 COLLATE=utf8mb4_0900_ai_ci;
